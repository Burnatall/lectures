# Компьютерное зрение
![Alt-текст](https://rdc.grfc.ru/wp-content/uploads/2021/04/comp-vision-2-e1619157338429.jpg)

## Определения и основные понятия

Компьютерное зрение (иначе техническое зрение) — теория и технология создания машин, которые могут производить обнаружение, отслеживание и классификацию объектов.

Как научная дисциплина, компьютерное зрение относится к теории и технологии создания искусственных систем, которые получают информацию из изображений.

### Машинное или компьютерное? 

Машинное зрение — это применение компьютерного зрения для промышленности и производства. В то время как компьютерное зрение — это общий набор методов

## Возникновение компьютерного зрения

Существуют много версий о дате возникновении компьютерного зрения, и о том, кто был его первым изобретателем.

Одна из первых известных статей по теме, которую можно отнести к области компьютерного зрения, была опубликована в 1959 году двумя нейропсихологами из медицинского института Wilmer при университете Джона Хопкинса, США (Wilmer Institute, The Johns Hopkins Hospital andUniversity, Baltimore, Maryland), Дэвидом Хубелем  (David Hubel) и Торстеном Визелем (Torsten Wiesel), под названием «Receptive fields of single neurons in the cat’s striate cortex»[1]. В статье описывались основные свойства зрительных корковых нейронов кошек, а также о том, как накопленный зрительный опыт кошки формирует корковую структуру (cortical architecture) мозга кошки.

Эту же статью, вероятно, также можно считать одной из первых публикаций по нейросетям.

![Alt-текст](https://shalaginov.files.wordpress.com/2020/05/2-1.jpg?w=474&h=316)

Однако, считается, что первая идея о том, чтобы научить компьютер видеть, возникла у профессора MIT (Массачусетский Институт Технологий) Лоуренса Робертса (Lawrence Roberts), которого называют одним из основателей Интернета. Он первым создал системы распознавания форм предметов при помощи компьютера, на чём защитил в MIT докторскую диссертацию (PhD).

В 1970 году Робертс уже читал в MIT курс по компьютерному зрению. В MIT ещё в конце 50-х была создана Лаборатория искусственного интеллекта (AI Lab). Позднее эта лаборатория стала также заниматься исследованиями по компьютерному зрению. Фактически, компьютерное зрение соотносится с AI так же, как глаза человека с его мозгом.

![Alt-текст](https://shalaginov.files.wordpress.com/2020/05/3.jpg?w=640)

На сегодняшний день существует множество направлений развитя компьютерного зрения, можно выделить основные связанные обасти:
 - Компьютерное зрение, Обработка изображений и Машинное зрение - тесно связанные области. Но до сих пор точно не определено, являются ли они разделами одной, более широкой. При детальном анализе может показаться, что это лишь разные названия одной и той же области. Чтобы не возникало путаницы, принято различать их как направления, сфокусированные на определённом предмете изучения. Ниже представлено описание некоторых из них, наиболее важных
 - Обработка изображений или анализ изображений, в основном сосредоточены на работе с двухмерными изображениями, то есть как преобразовать одно изображение в другое. Например, попиксельные операции увеличения контрастности, операции по выделению краёв, устранению шумов или геометрические преобразования, такие как Аффинные преобразования. Данные операции предполагают, что обработка/анализ изображения действуют независимо от содержания самих изображений.
 - Компьютерное зрение сосредотачивается на обработке трехмерных сцен, спроектированных на одно или несколько изображений. Например, восстановлением структуры или другой информации о трехмерной сцене по одному или нескольким изображениям. Компьютерное зрение часто зависит от более или менее сложных допущений относительно того, что представлено на изображениях.
 - Машинное зрение сосредотачивается на применении, в основном промышленном, например, автономные роботы и системы визуальной проверки и измерений. Это значит, что технологии датчиков изображения и теории управления связаны с обработкой видеоданных для управления роботом и обработка данных в реальном времени осуществляется аппаратно или программно.
 - Также существует область, названная Визуализация, которая первоначально была связана с процессом создания изображений, но иногда имела дело с обработкой и анализом. Например, рентгенография работает с анализом видеоданных медицинского применения.
 - Наконец, распознавание образов является областью, которая использует различные методы для получения информации из видеоданных, в основном, основанные на статистическом подходе. Значительная часть этой области посвящена практическому применению этих методов.
 
 ## Подробно о зонах применения технологий компьютерного зрения
 
 ### Медицина
 Одним из наиболее важных применений является обработка изображений в медицине. Эта область характеризуется получением информации из видеоданных для постановки медицинского диагноза пациентам
 
 Необходим лишь прибор который создат изображение - МРТ, УЗИ, Рентген. Снимки полученные с аппаратов можно обработать вручную, таким образом сейчас происходит подавляющий анализ всех результатов в мире.
 Однако сегодня компютерное зрение уже может состязаться в точности с человеческим зрением, если речь идет об однобразном исследовании похожей информации. Однако не все так просто.
 
 ![Alt-текст](https://www.secuteck.ru/hs-fs/hubfs/SecuteckRu/Articles/%D1%80%D0%B8%D1%8104-2.png?width=724&name=%D1%80%D0%B8%D1%8104-2.png)
 
 На рисунке представлена главная проблема использование ИИ и компьютерного зрения в области медицины, а именно точность. Очевидно что исследование здоровья человека должно иметь максимальную точность.
 Любая ошибка врача или ИИ может очень дорого обойтись пациенту. Из всего этого также следует этический вопрос, кто несет ответственность за ошибки ИИ? Если лечащий врач совершает ошибку он должен
 ее исправить и понести за нее какое либо наказание, речь не идет просто о том чтобы наказать провинившегося а о том чтобы данная ошибка не повторилась. Человек умеет обучаться в реальном времени с довольно высокой эффективностью и не ограничен рамками своей "программы", машина же напротив совершив ошибку почти со 100% вероятностью совершит ее вновь. Ошибки компьютера исправляют долго, а к тому моменту эти ошибки уже могут привести
 к плачевным последствиям. 
 
 Вот поэтому мы до сих пор не видим большого расапространения систем на рынке, а также самих разработок впринципе.
 
  ![Alt-текст](https://www.secuteck.ru/hs-fs/hubfs/SecuteckRu/Articles/%D1%80%D0%B8%D1%8103-1.png?width=724&name=%D1%80%D0%B8%D1%8103-1.png)
  
  На рисунке представлен анализ качества алгоритмов за 2018 год.
  
  Таким образом эта область хоть и является невероятно перспективной, но принципиальные проблемы точности еще не решены даже на момент 2022 года.
  По прогнозам аналитиков ИИ вобще никогда не сможет заменить врача, однако он может стать невероятно эффективным инструментом в их арсенале для диагностики и лечения пациентов.
  
  ### Промышленность
  
  Эта область невероятно огромна, поэтому компьютерное зрение находит в ней такое же огромное количество применений. Стоит выделить основные направления исследований
  
  #### Безопасность
  
  В промышленности часто используется видеонаблюдение с целю контроля сотрудников и безопасности на производстве, тот ли раобчи прошел под своим пропуском? правильно ли он выполняет свои должностные обязанности? на месте  ли он вообще? Все эти вопросы решаются простой камерой наблюдения и ее оператором, однако камер становится больше и вот опреатор уже не способен следить хоть за чем то на тысяче экранах, необходимо нанимать больше, а если необходимо следить за целым промышленным комплексом или несколькими комплексами? 
  
   ![Alt-текст](https://time.kz/files/000/033/uN7omRmt50931.jpg)
   
   Тут в дело вступает распознавание, которое позволит значительно уменьшить количество обслуживающего персонала камер наблюдения и даже обеспечеить прирост качества выявленя нарушений
   
   ![Alt-текст](https://habrastorage.org/r/w1560/webt/t0/-y/g3/t0-yg3hmejqw-oxmtebgvlmugio.jpeg)
   
   Эта область уже давно наполнена различными системами контроля и учета персонала основанных на компбютерном зрении, даже в России большинство крупных компаний уже много лет использует распознавание. 
   
   #### Контроль качества
   
   Еще одна область буквально созданная для применеия машинного зрения это контроль качества различной продукции.
   
   Как сейчас так и ранее в котроле качества принимали участие огромное количество людей, и чем больше производство тем больше и людей, а следовательно затрат.
   
   ![Alt-текст](https://static.wixstatic.com/media/f1bdbb_7faf8fc10bf2461599a4fbf9143ef95a~mv2.jpg/v1/fill/w_680,h_454,al_c,q_90/f1bdbb_7faf8fc10bf2461599a4fbf9143ef95a~mv2.jpg)
   
   Очевидно что эту работу может выполнять хорошо обученный ИИ.
   
   #### Автономные тарнспортные средства
   
   ![Alt-текст](https://motor.ru/imgs/2020/06/07/20/3946037/7ad92adf3cfcbf295b3e595645305b76c3c88bab.jpg)
   
   Относительно новой областью применения машинного зрения являются машины с автопилотом, там используются уже новейшие технологии распознавания и анализа информации, ведь все это необходимо делать с максимально возможной скоростью, для того чтобы автомобиль успевал реагировать на меняющиеся условия проезжей части.
   
   Эта область примечательна своей скоростью развития, на данный момент мы уже имеем проекты которые находятся на финальных стадиях тестирования, хотя начало активных исследований в этом направлении началось около 10 лет назад. Сейчас локомотивом этой области является Tesla, однако уже множество компаний заявило о подобных исследованиях и экспериментах.
   
   ![Alt-текст](https://avtopub.com/wp-content/uploads/2016/10/avtopilot-tesla-1.jpg)
   
   Согласно классификации SAE International существует 5 уровней автономности транспортного средства
   
   ![Alt-текст](https://ecars24.info/wp-content/uploads/2021/03/29/bez-vmeshatelstva-voditelya.jpg)
   
   Системы находящиеся на вершине этой цепочки, которые и устанавливаются на транспортное средство обычно используют огромный набор датчиков. Например в tesla, по их словам, используются 12 сенсоров объемного сканировани, что позволяет ис обрабатывать всю область вокруг автомобиля, а также "видеть" вперед на 250 метров. Для улучшения качества получаемых данных спереди используется радар, который игнорирует погодные условия и другие препядствия для обыного зрения.
   
   ![Alt-текст](https://ecars24.info/wp-content/uploads/2021/03/26/Printsip-raboty-avtopilota-Tesla.jpg)
   
   Все эти данные попадают в процессор для обработки при помощи ИИ. В данном случае используется нейронная сеть самой tesla для считывания и обработки данных с радара и сенсоров, а также последующего изменения конфигурации транспортного средства - поворот, объезд препятствия и т.д.
   
   Разумеется самая главная проблема таких систем это точность реакции ТС на изменяющиеся условия вокруг него. Автопилоты все еще несовершенны, а люди, напуганные возможностью попасть под колеса чудовищного устройства, в осносной своей массе все еще не доверяют даже автопилоту.
   
   Поэтому хоть эта область является весьма перспектиной до реального и повседневного использования необходима долгая работа как с системами так и с общественностью.
   
   #### Использование ИИ для создания интерактивных карт
   
   Область создания интерактивной карты с различными объектами на ней довольно обширна. Под интерактивностью данной карты обычно понимается то, что она способна обновляться в реальном времени. Чаще всего чтобы создать карту нам необходимо каким либо образом получить данные о расположении объектов на ней, чаще всего объектов дорожной инфраструктуры, дома, знаки, и различную разметку. Чтобы увеличить точность создания и нанессения новых объектов используются специальные машины - лабаратроии
   
   ![Alt-текст](https://raw.githubusercontent.com/Burnatall/lectures/main/LabSample.bmp)
   
   На изображении представлен результат работы лабаратории, мы имеем видео полученное с камеры на машине, а также трек который отображается на карте справа, после того как машина проедет необходимый маршрут и запишет всю необходимую видеоинформацию само видео попадает на обработку, которая включает в себя выделениенеобходимых объектов и вычисление некотороых интересующих нас данных.
   
   Однако некоторые объекты, такие как знаки например, встречаются слишком часто, а такие как дефекты дороги попросту незаметны для человеческого глаза, но не для ИИ.
   Т.к. распознавание по факту преобразует изображение в массив цветовой информации (OpenCV), а потом уже сравнивает эти массивы с набором данных обучения, сам Ии в данном случае будет гораздо более эффективн ораспознавать дефекты дороги чем обчный человек.
   
   ![Alt-текст](https://raw.githubusercontent.com/Burnatall/lectures/main/IssueSample.bmp)
   
   В данном случае также выделяется определенная часть кадра (нижняя половина), чтобы уменьшить круг поиска и отсечь ошибочное расознавание.
   
   ### Научное применение 
   
   Компьютерное зрение обширно используется в сферах науки связаныых с изучением графической информации, микробиология, астрономия и другие.
   
   ![Alt-текст](https://intergen.ru/assets/cache_image/assets/content/images/blog/luminescentnaya-microscopiya_400x300_8ab.jpg)
   
   ![Alt-текст](https://vlast.kz/media/pages/u7/15628404957wxl9_1000x768.jpg)
   
   
  
  ## Инновационные идеи по использованию систем на основе компьютерного зрения
  
  ### Системы улучшающие и имитирующие зрение человека
  
  В наши дни уже существуютуникальные исследования в направлении использования систем компьютерного зрения в медицине для воостановления зрительных функций людей с полной или частичной слепотой. Существуют несколько принципиальных теорий о способах восстановления зрения. Представим нашу нервную систему как сложный какнал для передачи информации, а мозг как ЦП всей нашей системы. Потеря зрения фактически может быть вызвана двумя факторами в такой системе это повреждение внешнего устройства получения зрительной информации (глаз) или обрыв или повреждение канала для передачи данных (нервной системы). Большинство наших разработок вв области создания устройств фото и видеосъемки ууже основаны на строении наших собственных глаз. В целом это хоть и грубо, но уже можно считать заменой нашего "внешнего устройства" в системе человека. Однако с каналом для передачи данных все обстоит иначе, мы все еще не способны передать информацию к нашему мозгу в таком же виде в котором она передается от наших внешних систем. Особенно это касается сложной информации такой как поток изображений. Все взаимодействия нашей нервной системы с искуственными устройствами на текущий момент ограничиваются только считываением и предачей обратно нервных импульсов. Из данного положения вытекает тот факт что прямая замена нашей зрительной системы на искуственно созданную невозможна на данном этапе развития.
  
  Есть и другая более реалистичная концепция с которой например работает университет Monash Australia. Она заключается не в прямой замене системы зрения человека, а в создании устройства, которое преобразует полученную с искуственного устройства информацию в более приемлемую для нашего мозга и передает ее по тем же каналам, которые использует наш мозг или напрямую взаимодействуя с этими каналами дял получения картинки уже в самом мозге. Таким образом уже сейчас создаются и тестируются устройства, которые при помощи камер и искуственного интелекта позволяют корректировать зрение для людей с дефектами зрительной системы. А некоторые из них могут помочь и полностью слепым людям.
  
  ![Alt-текст](https://mediaquotientinc.com/wp-content/uploads/2020/10/2020-10Oct-22-Gennaris-Bionic-Vision-System-Header.png)
  
  Стоит также отметить что большинство систем расчитаны на то что глаз человека хоть и поврежден но еще как минимум остается на месте, т.е. полной замены глаза еще не существет и системы просто возвращают функционал который наши глаза теряют в том или ином случае. Более того полученное таким образом зрение как правило является предметным - человек видит только очертания объектов.
   
   ### Виды систем улучшения и замены зрения человека
   
   Стоит рассказать о технологиях, которые связаны непосредственно с заменой клеток человека.
   
   ## Ретинальные нанотрубки
   Китайская разработка, которая использует нанотрубки заменяющие клетки сетчатки,в 2018 году были проведены мсследования на мышах, в целои эта технология основана на применении нового на тот момент материала - углеродных нанотрубок, также в системе интегрированы сложные системы основанные на компьютерном зрении для считывания полученной с самх трубок импульсов.
   
   ![Alt-текст](https://sdelanounas.ru/i/c/2/r/c2RlbGFub3VuYXMucnUvdXBsb2Fkcy83LzYvNzY4MTUzMDU4NTY0MF9vcmlnLmpwZWc_X19pZD0xMDkxMzY=.jpg)
   
   На данный момент, след этой технологии затерялся в информационном пространстве и дополнительная информация по проекту отстутсвует, делаем вывод что технология оказалась бесперспективной.
   
   ## Биопиксели
   
   Технология которая на данный момент находится на стадии разработки, она основана на полном копировании и искусственном воссоздании клеток сетчатки человека, оболочка из липидного слоя со встроенными фоточувствительными белками, после воздействия на них квантов света - в них меняется электрический потенциал.
   
   Существуют множество концептуальных аналогов данной технологии например с использованием гидрогелевых кубов которые выполняют все те же функции что и клетки сечатки глаза человека.
   
   ![Alt-текст](https://dailytechinfo.org/uploads/images4/20120101_1_1.jpg)
   
   Количество и качество информации по данным проектам говорят нам о том что эти проекты либо ведуться в секретности - мы видим только небольшие статьи в новостных агенствах, либо сам проект оказался бесперспективен.
   
   ## Перовскитная искусственная сетчатка
   
   Это похожая на прошлую технология, которая также основана на имитации клеток сетчатки человека, однако первоскит - это новый материал, который способен превращать свет в электрические импульсы, и ученые из Киатя на данный момент пытаются адаптировать этот материал не только для получения световых ощущений, но и для считывания цветовой информации.
   
   ![Alt-текст](https://s0.rbk.ru/v6_top_pics/resized/1005xH/media/img/4/20/755973332186204.jpg)
   
   ## Кортикальные системы имплантации
   
   Наконец мы подошли к технологии, которая в последнее время продвинулась как раз из за разработок в сфере ИИ и распознавания образов. Кортикальные системы это сложные устройства, которые считывают информацию в определенном виде с окружающей среды - обычно картинка с камеры или иногда только границы объектов, которые как правило получают при помощи искуственного интелекта, затем эта информация преобразуется в определенные электрические импульсы, отправляемые прямо в мозг человека, а именно в затылочную кору, которая отвечает за наше зрение
   
   ![Alt-текст](https://s0.rbk.ru/v6_top_pics/resized/1005xH/media/img/1/41/755973327516411.jpeg)
   
   Система должна уметь обрабатывать поток входящей информации в реальном времени, тут и используется ИИ, при использовании хорошего графического процессора мы можем добится того чтобы вся инофрмация автоматичеки "пересобиралась" в формат который наш мозг может распознать, т.к. пересборка такого изображения является невыполнимой алгоритмически - используются ИИ и распознавание. В частности они группируют информацию для последующей передачи импульсов.
   
   
   
   
   
